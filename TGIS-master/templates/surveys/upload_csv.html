{% extends 'base.html' %}
{% block content %}
<div class="max-w-lg mx-auto mt-10 bg-white rounded-xl shadow-lg p-8 animate-fade-in">
  <h2 class="text-2xl font-bold mb-6 text-gray-800">Upload CSV File</h2>
  <form method="post" enctype="multipart/form-data" class="space-y-6">
    {% csrf_token %}
    <div class="space-y-4">
      {{ form.as_p|safe }}
      <p class="text-sm text-gray-500 mt-2">Allowed file type: <strong>.csv</strong> | Max size: <strong>5MB</strong></p>
    </div>
    <button type="submit" class="w-full py-2 px-4 bg-blue-600 text-white font-semibold rounded-lg shadow-md hover:bg-blue-700 transition transform hover:scale-105">Upload</button>
  </form>
  <div id="progress-indicator" class="mt-4 text-blue-600 font-semibold animate-pulse hidden">Uploading...</div>
  <p class="mt-6 text-center">
    <a href="{% url 'csv_export' %}" class="text-blue-500 hover:underline font-medium">Download all survey records as CSV</a>
  </p>
  <p class="mt-2 text-center">
    <a href="{% url 'download_all_surveys_kml' %}" class="text-green-600 hover:underline font-medium">Download all survey records as KML</a>
  </p>
</div>
<script>
  // Show progress indicator on submit
  document.querySelector('form').addEventListener('submit', function() {
    document.getElementById('progress-indicator').classList.remove('hidden');
  });
  // Hide progress indicator on page load (in case of error/redirect)
  window.addEventListener('DOMContentLoaded', function() {
    setTimeout(function() {
      document.getElementById('progress-indicator').classList.add('hidden');
    }, 2000);
  });
</script>
{% endblock %}
